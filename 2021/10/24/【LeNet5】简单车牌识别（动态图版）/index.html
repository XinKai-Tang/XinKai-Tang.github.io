<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>【LeNet5】简单车牌识别（动态图版） | Kevin Tang</title><meta name="keywords" content="深度学习, 计算机视觉, paddlepaddle"><meta name="author" content="Kevin Tang"><meta name="copyright" content="Kevin Tang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="问题导入本次实践是一个多分类任务，需要将照片中的每个字符分别进行识别，故我们将借助CV2模块完成对车牌图像逐字符划分，然后训练卷积神经网络模型LeNet5完成对车牌的识别。   写在最后  如果您发现项目存在问题，或者如果您有更好的建议，欢迎在下方评论区中留言讨论~ 这是本项目的链接：实验项目 - Baidu AI Studio，点击fork可直接在AI Studio运行~ 这是我的个人主页：">
<meta property="og:type" content="article">
<meta property="og:title" content="【LeNet5】简单车牌识别（动态图版）">
<meta property="og:url" content="https://xinkai-tang.github.io/2021/10/24/%E3%80%90LeNet5%E3%80%91%E7%AE%80%E5%8D%95%E8%BD%A6%E7%89%8C%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/index.html">
<meta property="og:site_name" content="Kevin Tang">
<meta property="og:description" content="问题导入本次实践是一个多分类任务，需要将照片中的每个字符分别进行识别，故我们将借助CV2模块完成对车牌图像逐字符划分，然后训练卷积神经网络模型LeNet5完成对车牌的识别。   写在最后  如果您发现项目存在问题，或者如果您有更好的建议，欢迎在下方评论区中留言讨论~ 这是本项目的链接：实验项目 - Baidu AI Studio，点击fork可直接在AI Studio运行~ 这是我的个人主页：">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xinkai-tang.github.io/img/banner.jpg">
<meta property="article:published_time" content="2021-10-24T04:58:10.000Z">
<meta property="article:modified_time" content="2022-05-11T05:09:49.961Z">
<meta property="article:author" content="Kevin Tang">
<meta property="article:tag" content="深度学习, 计算机视觉, paddlepaddle">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xinkai-tang.github.io/img/banner.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://xinkai-tang.github.io/2021/10/24/%E3%80%90LeNet5%E3%80%91%E7%AE%80%E5%8D%95%E8%BD%A6%E7%89%8C%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【LeNet5】简单车牌识别（动态图版）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-11 13:09:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 档案馆</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/banner.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Kevin Tang</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 档案馆</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【LeNet5】简单车牌识别（动态图版）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-10-24T04:58:10.000Z" title="发表于 2021-10-24 12:58:10">2021-10-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-05-11T05:09:49.961Z" title="更新于 2022-05-11 13:09:49">2022-05-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【LeNet5】简单车牌识别（动态图版）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><span id="more"></span>

<h1 id="问题导入"><a href="#问题导入" class="headerlink" title="问题导入"></a>问题导入</h1><p>本次实践是一个多分类任务，需要将照片中的每个字符分别进行识别，故我们将借助CV2模块完成对车牌图像逐字符划分，然后训练卷积神经网络模型LeNet5完成对车牌的识别。<br><img style="width: 750px; margin: 10px 0px" src="https://ai-studio-static-online.cdn.bcebos.com/72043798ca984884aa763235fb008cfaba626d0815ef43bcbc81fe38e0bcc775"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h1 id="一、基本概念"><a href="#一、基本概念" class="headerlink" title="一、基本概念"></a>一、基本概念</h1><h2 id="1-动态图DyGraph"><a href="#1-动态图DyGraph" class="headerlink" title="1. 动态图DyGraph"></a>1. 动态图DyGraph</h2><p>（1）PaddlePaddle动态图：</p>
<blockquote>
<p>PaddlePaddle的 <strong>动态图DyGraph模式</strong> 是一个更加灵活易用的模式，是一种动态的图执行机制，可以立即执行结果，无需构建整个图。PaddlePaddle DyGraph可以提供：</p>
<ul>
<li>更加灵活便捷的代码组织结构：使用python的执行控制流程和面向对象的模型设计</li>
<li>更加便捷的调试功能：直接使用python的打印方法即时打印所需要的结果，从而检查正在运行的模型结果便于测试更改</li>
<li>和静态执行图通用的模型代码：同样的模型代码可以使用更加便捷的DyGraph调试，执行，同时也支持使用原有的静态图模式执行</li>
</ul>
</blockquote>
<p>（2）动态图机制的优点：</p>
<blockquote>
<p>动态图机制不同于以往的静态图，无需构建整个图就可以立即执行结果。这使得我们在编写代码以及调试代码时更加直观、方便，我们无需编写静态图框架，这省去了我们大量的时间成本。利用动态图机制，我们能够更加快捷、直观地构建我们的深度学习网络。</p>
</blockquote>
<p>本项目采用的是动态图机制，动态图机制的使用方法请参考：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.paddlepaddle.org.cn/documentation/docs/zh/1.6/user_guides/howto/dygraph/DyGraph.html">动态图机制-DyGraph - PaddlePaddle文档</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/PaddlePaddle/article/details/100059492">还不懂动态图吗？一文带你了解飞桨动态图 - CSDN</a></li>
</ul>
<h2 id="2-LeNet5模型"><a href="#2-LeNet5模型" class="headerlink" title="2. LeNet5模型"></a>2. LeNet5模型</h2><p><strong>LeNet-5</strong> 源自<strong>Yann LeCun</strong>的论文 “Gradient-Based Learning Applied to Document Recognition”，是一种用于手写体字符识别的、结构简单、非常高效的卷积神经网络。<br><img src="https://img-blog.csdnimg.cn/img_convert/0e0ac55b2236b69467b670d919b8bb34.png#pic_center"></p>
<h1 id="二、实验数据集"><a href="#二、实验数据集" class="headerlink" title="二、实验数据集"></a>二、实验数据集</h1><p>实验数据集中有65个文件夹，包含数字 (0-9)、大写字母 (A-Z) 以及各省简称，每个文件夹存放一类图片，所有的图片均为120 * 120像素的灰度图像。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/14960b16959204c3e2b473410a46dda1.png#pic_center"></p>
<blockquote>
<p>这是数据集的下载链接：<a target="_blank" rel="noopener" href="https://aistudio.baidu.com/aistudio/datasetdetail/23617">车牌识别数据集 - Baidu AI Studio</a></p>
</blockquote>
<h1 id="三、实验步骤"><a href="#三、实验步骤" class="headerlink" title="三、实验步骤"></a>三、实验步骤</h1><img width="800px" src="https://ai-studio-static-online.cdn.bcebos.com/daa656fb63c54dec8e0e468ba8f65e1c94ccd7debd314d8ca6d179f12f13883d">

<h2 id="0-导入模块"><a href="#0-导入模块" class="headerlink" title="0. 导入模块"></a>0. 导入模块</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> cv2       <span class="comment"># 在本项目中，它主要用来分割图像</span></span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> cpu_count</span><br><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"><span class="keyword">from</span> paddle <span class="keyword">import</span> fluid</span><br><span class="line"><span class="keyword">from</span> paddle.fluid.dygraph <span class="keyword">import</span> Conv2D, Pool2D, Linear</span><br></pre></td></tr></table></figure>

<h2 id="1-数据准备"><a href="#1-数据准备" class="headerlink" title="1. 数据准备"></a>1. 数据准备</h2><ul>
<li><strong>数据预处理</strong><br>训练&#x2F;测试数据集包含车牌中出现的所有字符的图片，本次实验将取其中的90%作为训练集，剩下的10%作为测试集。数据预处理的流程如下：<br>（1）由于数据集中的数据是以压缩包的形式存放的，因此我们需要先解压数据压缩包。<br>（2）接着，我们需要按1:9比例划分测试集和训练集，分别生成包含数据地址的两个列表。<br>（3）然后，我们需要分别构建用于训练和测试的数据提供器，其中训练数据提供器是乱序、按批次提供数据的。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">unzip_data</span>(<span class="params">target_path</span>):      <span class="comment"># 将原数据集解压至指定路径</span></span><br><span class="line">    src_path = <span class="string">&quot;./data/data23617/characterData.zip&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(target_path):</span><br><span class="line">        z = zipfile.ZipFile(src_path, <span class="string">&#x27;r&#x27;</span>)   <span class="comment"># 打开Zip文件，创建Zip对象</span></span><br><span class="line">        z.extractall(path=target_path)       <span class="comment"># 解压Zip文件至target_path</span></span><br><span class="line">        shutil.rmtree(<span class="string">&quot;./data/dataset/__MACOSX&quot;</span>)     <span class="comment"># 删除无关文件</span></span><br><span class="line">        z.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;数据集解压完成！&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_mapper</span>(<span class="params">sample</span>):    <span class="comment"># 对图片进行预处理</span></span><br><span class="line">    img_path, label = sample</span><br><span class="line">    img = Image.<span class="built_in">open</span>(img_path).convert(<span class="string">&quot;L&quot;</span>)  <span class="comment"># 将图像打开并转为灰度图</span></span><br><span class="line">    img = img.resize((<span class="number">32</span>, <span class="number">32</span>), Image.ANTIALIAS)</span><br><span class="line">    img = np.array(img).reshape(<span class="number">1</span>, <span class="number">1</span>, <span class="number">32</span>, <span class="number">32</span>)\</span><br><span class="line">        .astype(<span class="string">&#x27;float32&#x27;</span>)          <span class="comment"># 把图像变成numpy数组以匹配数据馈送格式</span></span><br><span class="line">    img = img / <span class="number">255.0</span> * <span class="number">2.0</span> - <span class="number">1.0</span>   <span class="comment"># 将数据归一化到[-1, 1]之间</span></span><br><span class="line">    <span class="keyword">return</span> img, label</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_reader</span>(<span class="params">data_list</span>):  <span class="comment"># 按批量读取图片</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reader</span>():</span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> data_list:</span><br><span class="line">            img_path, label = data[<span class="number">0</span>], data[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">yield</span> img_path, <span class="built_in">int</span>(label)  <span class="comment"># 返回图像路径和标签（for循环结束前程序不会停止）</span></span><br><span class="line">    <span class="keyword">return</span> paddle.reader.xmap_readers(data_mapper, reader, cpu_count(), <span class="number">1024</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ------ 1.1.解压数据集 ------</span></span><br><span class="line">data_path = <span class="string">&quot;./data/dataset&quot;</span>             <span class="comment"># 数据集路径</span></span><br><span class="line">unzip_data(data_path)                    <span class="comment"># 解压原数据集至指定路径</span></span><br><span class="line">file_folders = os.listdir(data_path)     <span class="comment"># data_path路径下的文件夹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ------ 1.2.划分数据集 ------</span></span><br><span class="line">train_list, test_list = [], []           <span class="comment"># 存放训练集和数据集的位置以及类别</span></span><br><span class="line">char_num, label_dict = <span class="number">0</span>, &#123;&#125;             <span class="comment"># 方便字符在整型和字符型之间转换</span></span><br><span class="line"><span class="keyword">for</span> folder <span class="keyword">in</span> file_folders:</span><br><span class="line">    label_dict[<span class="built_in">str</span>(char_num)] = folder  <span class="comment"># 记录标签和代号的对应关系</span></span><br><span class="line">    images = os.listdir(os.path.join(data_path, folder))</span><br><span class="line">    <span class="keyword">for</span> idx, img <span class="keyword">in</span> <span class="built_in">enumerate</span>(images):</span><br><span class="line">        img_path = os.path.join(data_path, folder, img)</span><br><span class="line">        value = [img_path, char_num]</span><br><span class="line">        <span class="keyword">if</span> idx % <span class="number">10</span> == <span class="number">0</span>:      <span class="comment"># 按照1:9的比例划分数据集</span></span><br><span class="line">            test_list.append(value)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            train_list.append(value)</span><br><span class="line">    char_num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">random.shuffle(train_list)    <span class="comment"># 打乱训练集数据</span></span><br><span class="line">random.shuffle(test_list)     <span class="comment"># 打乱测试集数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ------ 1.3.准备训练数据集 ------</span></span><br><span class="line">BUF_SIZE, BATCH_SIZE = <span class="number">512</span>, <span class="number">128</span></span><br><span class="line">train_reader = paddle.batch(</span><br><span class="line">    paddle.reader.shuffle(</span><br><span class="line">        data_reader(train_list), buf_size=BUF_SIZE</span><br><span class="line">    ),  <span class="comment"># 每次缓存BUF_SIZE个训练数据项，并打乱</span></span><br><span class="line">    batch_size=BATCH_SIZE</span><br><span class="line">)   <span class="comment"># 按批次读取乱序后的训练数据，批次大小为BATCH_SIZE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ------ 1.4.准备测试数据集 ------</span></span><br><span class="line">test_reader = paddle.batch(</span><br><span class="line">    data_reader(test_list), batch_size=BATCH_SIZE</span><br><span class="line">)   <span class="comment"># 按批次读取测试数据，批次大小为BATCH_SIZE</span></span><br></pre></td></tr></table></figure>

<h2 id="2-网络配置"><a href="#2-网络配置" class="headerlink" title="2. 网络配置"></a>2. 网络配置</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyLeNet</span>(fluid.dygraph.Layer):     <span class="comment"># 构建CNN模型类</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MyLeNet, self).__init__()</span><br><span class="line">        self.c1 = Conv2D(               <span class="comment"># 定义一个卷积层</span></span><br><span class="line">            num_channels=<span class="number">1</span>,   <span class="comment"># 输入的通道数</span></span><br><span class="line">            num_filters=<span class="number">6</span>,    <span class="comment"># 卷积核的个数</span></span><br><span class="line">            filter_size=<span class="number">5</span>,    <span class="comment"># 卷积核的大小</span></span><br><span class="line">            stride=<span class="number">1</span>          <span class="comment"># 卷积层的步长</span></span><br><span class="line">        )</span><br><span class="line">        self.s2 = Pool2D(               <span class="comment"># 定义一个池化层</span></span><br><span class="line">            pool_size=<span class="number">2</span>,      <span class="comment"># 池化核的大小</span></span><br><span class="line">            pool_type=<span class="string">&quot;max&quot;</span>,  <span class="comment"># 池化类型：“max” or “avg”</span></span><br><span class="line">            pool_stride=<span class="number">2</span>     <span class="comment"># 池化层的步长</span></span><br><span class="line">        )</span><br><span class="line">        self.c3 = Conv2D(<span class="number">6</span>, <span class="number">16</span>, <span class="number">5</span>, <span class="number">1</span>)</span><br><span class="line">        self.s4 = Pool2D(<span class="number">2</span>, <span class="string">&quot;max&quot;</span>, <span class="number">2</span>)</span><br><span class="line">        self.c5 = Conv2D(<span class="number">16</span>, <span class="number">120</span>, <span class="number">5</span>, <span class="number">1</span>)</span><br><span class="line">        self.f6 = Linear(<span class="number">120</span>, <span class="number">84</span>, act=<span class="string">&quot;relu&quot;</span>)</span><br><span class="line">        self.output = Linear(<span class="number">84</span>, char_num, act=<span class="string">&quot;softmax&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span></span>):</span><br><span class="line">        x = self.c1(<span class="built_in">input</span>)   <span class="comment"># 输出维度为28*28*6</span></span><br><span class="line">        x = self.s2(x)       <span class="comment"># 输出维度为14*14*6</span></span><br><span class="line">        x = self.c3(x)       <span class="comment"># 输出维度为10*10*6</span></span><br><span class="line">        x = self.s4(x)       <span class="comment"># 输出维度为5*5*16</span></span><br><span class="line">        x = self.c5(x)       <span class="comment"># 输出维度为120</span></span><br><span class="line">        x = fluid.layers.reshape(x, shape=[-<span class="number">1</span>, <span class="number">120</span>])</span><br><span class="line">        x = self.f6(x)       <span class="comment"># 输出维度为84</span></span><br><span class="line">        y = self.output(x)   <span class="comment"># 输出维度为10</span></span><br><span class="line">        <span class="keyword">return</span> y</span><br></pre></td></tr></table></figure>

<h2 id="3-模型训练"><a href="#3-模型训练" class="headerlink" title="3. 模型训练"></a>3. 模型训练</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">EPOCH_NUM, train_iter = <span class="number">25</span>, <span class="number">0</span></span><br><span class="line">train_iters, train_costs, train_accs = [], [], []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_training_loss</span>(<span class="params">iters, costs</span>):    <span class="comment"># 绘制训练误差图像</span></span><br><span class="line">    plt.figure(figsize=[<span class="number">10</span>, <span class="number">5</span>])</span><br><span class="line">    plt.title(<span class="string">&quot;Training Loss&quot;</span>, fontsize=<span class="number">25</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&quot;iter&quot;</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&quot;loss&quot;</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">    plt.plot(iters, costs, color=<span class="string">&quot;r&quot;</span>)</span><br><span class="line">    plt.grid()</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_training_acc</span>(<span class="params">iters, accs</span>):     <span class="comment"># 绘制训练准确率图像</span></span><br><span class="line">    plt.figure(figsize=[<span class="number">10</span>, <span class="number">5</span>])</span><br><span class="line">    plt.title(<span class="string">&quot;Training Accuracy&quot;</span>, fontsize=<span class="number">25</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&quot;iter&quot;</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&quot;accuracy&quot;</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">    plt.plot(iters, accs, color=<span class="string">&quot;g&quot;</span>)</span><br><span class="line">    plt.grid()</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> fluid.dygraph.guard():      <span class="comment"># 使用动态图进行模型训练</span></span><br><span class="line">    model = MyLeNet()    <span class="comment"># 模型实例化</span></span><br><span class="line">    model.train()        <span class="comment"># 开启训练模式</span></span><br><span class="line">    opt = fluid.optimizer.AdamOptimizer(</span><br><span class="line">        learning_rate=fluid.dygraph.ExponentialDecay(</span><br><span class="line">            learning_rate=<span class="number">0.001</span>,  <span class="comment"># 初始学习率</span></span><br><span class="line">            decay_steps=<span class="number">750</span>,      <span class="comment"># 学习率衰减步长</span></span><br><span class="line">            decay_rate=<span class="number">0.25</span>,      <span class="comment"># 学习率衰减率</span></span><br><span class="line">            staircase=<span class="literal">True</span>        <span class="comment"># 每decay_steps步学习率衰减为原来的decay_rate</span></span><br><span class="line">        ),  <span class="comment"># 学习率呈现指数衰减</span></span><br><span class="line">        parameter_list=model.parameters()</span><br><span class="line">    )   <span class="comment"># 定义优化器，采用Adam优化算法</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> pass_id <span class="keyword">in</span> <span class="built_in">range</span>(EPOCH_NUM):    <span class="comment"># 训练EPOCH_NUM轮</span></span><br><span class="line">        <span class="keyword">for</span> batch_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_reader()):</span><br><span class="line">            <span class="comment"># 将数据集中的图像、标签数据转化为numpy.array格式的数据：</span></span><br><span class="line">            image = np.array([x[<span class="number">0</span>].reshape(<span class="number">1</span>, <span class="number">32</span>, <span class="number">32</span>) <span class="keyword">for</span> x <span class="keyword">in</span> data], np.float32)</span><br><span class="line">            label = np.array([x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> data]).astype(<span class="string">&quot;int64&quot;</span>)</span><br><span class="line">            label = label[:, np.newaxis]    <span class="comment"># 在label中增加一维维度</span></span><br><span class="line">            <span class="comment"># 将数据转化为fluid.dygraph能够接受的Variable类型的对象：</span></span><br><span class="line">            image = fluid.dygraph.to_variable(image)</span><br><span class="line">            label = fluid.dygraph.to_variable(label)</span><br><span class="line"></span><br><span class="line">            predict = model(image)   <span class="comment"># 训练模型</span></span><br><span class="line">            train_loss = fluid.layers.cross_entropy(predict, label)  <span class="comment"># 计算交叉熵</span></span><br><span class="line">            avg_loss = fluid.layers.mean(train_loss)                 <span class="comment"># 求平均损失值</span></span><br><span class="line">            train_acc = fluid.layers.accuracy(predict, label)        <span class="comment"># 计算准确率</span></span><br><span class="line"></span><br><span class="line">            train_iter += BATCH_SIZE</span><br><span class="line">            train_iters.append(train_iter)            <span class="comment"># 迭代次数</span></span><br><span class="line">            train_costs.append(avg_loss.numpy()[<span class="number">0</span>])   <span class="comment"># 训练误差</span></span><br><span class="line">            train_accs.append(train_acc.numpy()[<span class="number">0</span>])   <span class="comment"># 训练准确率</span></span><br><span class="line">            <span class="keyword">if</span> batch_id != <span class="number">0</span> <span class="keyword">and</span> batch_id % <span class="number">110</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Pass：%3d；Batch：%2d；Loss：%.5f；Accuracy：%.5f&quot;</span> %</span><br><span class="line">                        (pass_id, batch_id, train_costs[-<span class="number">1</span>], train_accs[-<span class="number">1</span>]))</span><br><span class="line">            </span><br><span class="line">            avg_loss.backward()      <span class="comment"># 执行反向传播算法</span></span><br><span class="line">            opt.minimize(avg_loss)   <span class="comment"># 调用优化器中的minimize()方法更新参数</span></span><br><span class="line">            model.clear_gradients()  <span class="comment"># 每轮参数更新后需重置梯度，以确保下轮的正确性</span></span><br><span class="line">        </span><br><span class="line">    draw_training_loss(train_iters, train_costs)        <span class="comment"># 绘制训练损失值图像</span></span><br><span class="line">    draw_training_acc(train_iters, train_accs)          <span class="comment"># 绘制训练准确率图像</span></span><br><span class="line">    fluid.save_dygraph(model.state_dict(), <span class="string">&quot;MyLeNet&quot;</span>)   <span class="comment"># 保存训练好的模型</span></span><br></pre></td></tr></table></figure>
<p>模型训练结果如下：</p>
<pre><code>Pass：  0；Batch：110；Loss：0.34848；Accuracy：0.89844
Pass：  1；Batch：110；Loss：0.13844；Accuracy：0.96875
Pass：  2；Batch：110；Loss：0.08487；Accuracy：0.96875
Pass：  3；Batch：110；Loss：0.07444；Accuracy：0.98438
Pass：  4；Batch：110；Loss：0.05620；Accuracy：0.99219
Pass：  5；Batch：110；Loss：0.07430；Accuracy：0.98438
Pass：  6；Batch：110；Loss：0.03116；Accuracy：0.99219
Pass：  7；Batch：110；Loss：0.01135；Accuracy：1.00000
Pass：  8；Batch：110；Loss：0.00264；Accuracy：1.00000
Pass：  9；Batch：110；Loss：0.00669；Accuracy：1.00000
Pass： 10；Batch：110；Loss：0.00272；Accuracy：1.00000
Pass： 11；Batch：110；Loss：0.00407；Accuracy：1.00000
Pass： 12；Batch：110；Loss：0.01096；Accuracy：1.00000
Pass： 13；Batch：110；Loss：0.00288；Accuracy：1.00000
Pass： 14；Batch：110；Loss：0.00631；Accuracy：1.00000
Pass： 15；Batch：110；Loss：0.00285；Accuracy：1.00000
Pass： 16；Batch：110；Loss：0.00256；Accuracy：1.00000
Pass： 17；Batch：110；Loss：0.00322；Accuracy：1.00000
Pass： 18；Batch：110；Loss：0.00195；Accuracy：1.00000
Pass： 19；Batch：110；Loss：0.00297；Accuracy：1.00000
Pass： 20；Batch：110；Loss：0.00217；Accuracy：1.00000
Pass： 21；Batch：110；Loss：0.00373；Accuracy：1.00000
Pass： 22；Batch：110；Loss：0.00482；Accuracy：1.00000
Pass： 23；Batch：110；Loss：0.00120；Accuracy：1.00000
Pass： 24；Batch：110；Loss：0.00188；Accuracy：1.00000
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/20210211225405102.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RYS19LZXZpbg==,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210211225405123.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RYS19LZXZpbg==,size_16,color_FFFFFF,t_70"></p>
<h2 id="4-模型评估"><a href="#4-模型评估" class="headerlink" title="4. 模型评估"></a>4. 模型评估</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> fluid.dygraph.guard():       <span class="comment"># 使用动态图进行模型测试</span></span><br><span class="line">    test_costs, test_accs = [], []</span><br><span class="line">    model = MyLeNet()    <span class="comment"># 模型实例化</span></span><br><span class="line">    model_dict, _ = fluid.load_dygraph(<span class="string">&quot;MyLeNet&quot;</span>)  <span class="comment"># 加载模型参数</span></span><br><span class="line">    model.load_dict(model_dict)         <span class="comment"># 将模型参数载入到新模型中</span></span><br><span class="line">    model.<span class="built_in">eval</span>()         <span class="comment"># 开启评估模式</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> batch_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(test_reader()):</span><br><span class="line">        <span class="comment"># 将数据集中的图像、标签数据转化为特定numpy数组格式的数据：</span></span><br><span class="line">        image = np.array([x[<span class="number">0</span>].reshape(<span class="number">1</span>, <span class="number">32</span>, <span class="number">32</span>) <span class="keyword">for</span> x <span class="keyword">in</span> data], np.float32)</span><br><span class="line">        label = np.array([x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> data]).astype(<span class="string">&quot;int64&quot;</span>)[:, np.newaxis]</span><br><span class="line">        <span class="comment"># 将数据转化为fluid.dygraph能够接受的Variable类型的对象：</span></span><br><span class="line">        image = fluid.dygraph.to_variable(image)</span><br><span class="line">        label = fluid.dygraph.to_variable(label)</span><br><span class="line"></span><br><span class="line">        predict = model(image)   <span class="comment"># 模型测试</span></span><br><span class="line">        test_loss = fluid.layers.cross_entropy(predict, label)  <span class="comment"># 计算交叉熵</span></span><br><span class="line">        avg_loss = fluid.layers.mean(test_loss)                 <span class="comment"># 计算平均损失值</span></span><br><span class="line">        test_costs.append(avg_loss.numpy()[<span class="number">0</span>])</span><br><span class="line">        test_acc = fluid.layers.accuracy(predict, label)        <span class="comment"># 计算准确率</span></span><br><span class="line">        test_accs.append(test_acc.numpy()[<span class="number">0</span>])</span><br><span class="line">    </span><br><span class="line">    test_loss = np.mean(test_costs)     <span class="comment"># 计算平均损失值</span></span><br><span class="line">    test_acc = np.mean(test_accs)       <span class="comment"># 计算平均准确率</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Eval \t Avg_Loss：%.5f；Accuracy：%.5f&quot;</span> % (test_loss, test_acc))</span><br></pre></td></tr></table></figure>
<p>模型评估结果如下：</p>
<pre><code>Eval 	 Avg_Loss：0.12136；Accuracy：0.98006
</code></pre>
<h2 id="5-模型预测"><a href="#5-模型预测" class="headerlink" title="5. 模型预测"></a>5. 模型预测</h2><ul>
<li><strong>预测图片预处理</strong><br>由于车牌图片是由多个字符构成的RGB模式的图片，因此在进行预测之前需要将车牌图片转化为灰度图并按字符划分子图像，以便于模型逐字符进行预测。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">load_image</span>(<span class="params">path</span>):          <span class="comment"># 图像整体预处理</span></span><br><span class="line">    img = Image.<span class="built_in">open</span>(path).convert(<span class="string">&quot;L&quot;</span>)    <span class="comment"># 将图像打开并转为灰度图</span></span><br><span class="line">    img = img.resize((<span class="number">32</span>, <span class="number">32</span>), Image.ANTIALIAS)</span><br><span class="line">    img = np.array(img).reshape(<span class="number">1</span>, <span class="number">1</span>, <span class="number">32</span>, <span class="number">32</span>)\</span><br><span class="line">        .astype(<span class="string">&#x27;float32&#x27;</span>)          <span class="comment"># 把图像变成numpy数组以匹配数据馈送格式</span></span><br><span class="line">    img = img / <span class="number">255.0</span> * <span class="number">2.0</span> - <span class="number">1.0</span>   <span class="comment"># 将数据归一化到[-1, 1]之间</span></span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divide_picture</span>(<span class="params">path</span>):      <span class="comment"># 分割出车牌图像中的每一个字符并保存</span></span><br><span class="line">    <span class="comment"># (1) 图片灰度化处理：</span></span><br><span class="line">    license = cv2.imread(path)</span><br><span class="line">    gray_img = cv2.cvtColor(license, cv2.COLOR_RGB2GRAY)  <span class="comment"># 将车牌转化为灰度图</span></span><br><span class="line">    retval, bin_img = cv2.threshold(                      <span class="comment"># 进行图像二值化操作</span></span><br><span class="line">        gray_img, <span class="number">100</span>, <span class="number">255</span>, cv2.THRESH_BINARY  <span class="comment"># 源图片、起始阈值、最大阈值、阈值类型</span></span><br><span class="line">    )   <span class="comment"># 函数返回值：retval是阈值；bin_img是根据阈值处理后的图像</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># (2) 按列统计像素分布：</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(bin_img.shape[<span class="number">1</span>]):</span><br><span class="line">        result.append(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(bin_img.shape[<span class="number">0</span>]):</span><br><span class="line">            result[col] += bin_img[row][col] / <span class="number">255.0</span>    <span class="comment"># 统计归一化后的像素分布</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># (3) 记录车牌中的字符的位置：</span></span><br><span class="line">    place_dict, num, i = &#123;&#125;, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(result):</span><br><span class="line">        <span class="keyword">if</span> result[i] == <span class="number">0</span>:</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            index = i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> result[index] != <span class="number">0</span>:</span><br><span class="line">                index += <span class="number">1</span></span><br><span class="line">            place_dict[num] = [i, index-<span class="number">1</span>]</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line">            i = index</span><br><span class="line"></span><br><span class="line">    <span class="comment"># (4) 将每个字符填充并存储：</span></span><br><span class="line">    characters = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">2</span>:   <span class="comment"># 跳过蓝牌中的“•”号</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        padding = (<span class="number">170</span> - (place_dict[i][<span class="number">1</span>] - place_dict[i][<span class="number">0</span>])) / <span class="number">2</span></span><br><span class="line">        ndarray = np.pad(     <span class="comment"># 将单个字符图像填充为170*170</span></span><br><span class="line">            bin_img[:, place_dict[i][<span class="number">0</span>]: place_dict[i][<span class="number">1</span>]],</span><br><span class="line">            ((<span class="number">0</span>, <span class="number">0</span>), (<span class="built_in">int</span>(padding), <span class="built_in">int</span>(padding))),</span><br><span class="line">            <span class="string">&quot;constant&quot;</span>,</span><br><span class="line">            constant_values=(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        )</span><br><span class="line">        ndarray = cv2.resize(ndarray, (<span class="number">20</span>, <span class="number">20</span>))</span><br><span class="line">        cv2.imwrite(<span class="string">&quot;./data/%d.png&quot;</span> % i, ndarray)   <span class="comment"># 保存划分后的单字符图片</span></span><br><span class="line">        characters.append(ndarray)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">match_labels</span>(<span class="params">label_dict</span>):  <span class="comment"># 返回将标签进行转换的字典</span></span><br><span class="line">    temp = &#123;<span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>: <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>: <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;G&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>: <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>: <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>: <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>: <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>: <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>: <span class="string">&#x27;N&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>: <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>: <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>: <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>: <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;8&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;yun&#x27;</span>: <span class="string">&#x27;云&#x27;</span>, <span class="string">&#x27;cuan&#x27;</span>: <span class="string">&#x27;川&#x27;</span>, <span class="string">&#x27;hei&#x27;</span>: <span class="string">&#x27;黑&#x27;</span>, <span class="string">&#x27;zhe&#x27;</span>: <span class="string">&#x27;浙&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ning&#x27;</span>: <span class="string">&#x27;宁&#x27;</span>, <span class="string">&#x27;jin&#x27;</span>: <span class="string">&#x27;津&#x27;</span>, <span class="string">&#x27;gan&#x27;</span>: <span class="string">&#x27;赣&#x27;</span>, <span class="string">&#x27;hu&#x27;</span>: <span class="string">&#x27;沪&#x27;</span>, <span class="string">&#x27;liao&#x27;</span>: <span class="string">&#x27;辽&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;jl&#x27;</span>: <span class="string">&#x27;吉&#x27;</span>, <span class="string">&#x27;qing&#x27;</span>: <span class="string">&#x27;青&#x27;</span>, <span class="string">&#x27;zang&#x27;</span>: <span class="string">&#x27;藏&#x27;</span>, <span class="string">&#x27;e1&#x27;</span>: <span class="string">&#x27;鄂&#x27;</span>, <span class="string">&#x27;meng&#x27;</span>: <span class="string">&#x27;蒙&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;gan1&#x27;</span>: <span class="string">&#x27;甘&#x27;</span>, <span class="string">&#x27;qiong&#x27;</span>: <span class="string">&#x27;琼&#x27;</span>, <span class="string">&#x27;shan&#x27;</span>: <span class="string">&#x27;陕&#x27;</span>, <span class="string">&#x27;min&#x27;</span>: <span class="string">&#x27;闽&#x27;</span>, <span class="string">&#x27;su&#x27;</span>: <span class="string">&#x27;苏&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;xin&#x27;</span>: <span class="string">&#x27;新&#x27;</span>, <span class="string">&#x27;wan&#x27;</span>: <span class="string">&#x27;皖&#x27;</span>, <span class="string">&#x27;jing&#x27;</span>: <span class="string">&#x27;京&#x27;</span>, <span class="string">&#x27;xiang&#x27;</span>: <span class="string">&#x27;湘&#x27;</span>, <span class="string">&#x27;gui&#x27;</span>: <span class="string">&#x27;贵&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;yu1&#x27;</span>: <span class="string">&#x27;渝&#x27;</span>, <span class="string">&#x27;yu&#x27;</span>: <span class="string">&#x27;豫&#x27;</span>, <span class="string">&#x27;ji&#x27;</span>: <span class="string">&#x27;冀&#x27;</span>, <span class="string">&#x27;yue&#x27;</span>: <span class="string">&#x27;粤&#x27;</span>, <span class="string">&#x27;gui1&#x27;</span>: <span class="string">&#x27;桂&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sx&#x27;</span>: <span class="string">&#x27;晋&#x27;</span>, <span class="string">&#x27;lu&#x27;</span>: <span class="string">&#x27;鲁&#x27;</span>&#125;      <span class="comment"># 本次转换的目的是转换字母和汉字</span></span><br><span class="line">    name_dict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> key, val <span class="keyword">in</span> label_dict.items():</span><br><span class="line">        name_dict[key] = temp[val]</span><br><span class="line">    <span class="keyword">return</span> name_dict</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> fluid.dygraph.guard():</span><br><span class="line">    model = MyLeNet()     <span class="comment"># 实例化模型</span></span><br><span class="line">    model_dict, _ = fluid.load_dygraph(<span class="string">&quot;MyLeNet&quot;</span>)  <span class="comment"># 加载模型参数</span></span><br><span class="line">    model.load_dict(model_dict)         <span class="comment"># 将模型参数载入到新模型中</span></span><br><span class="line">    model.<span class="built_in">eval</span>()          <span class="comment"># 开启评估模式</span></span><br><span class="line"></span><br><span class="line">    infer_label = <span class="string">&quot;&quot;</span>      <span class="comment"># 存储预测结果</span></span><br><span class="line">    infer_path = <span class="string">&quot;./work/infer_license.png&quot;</span>  <span class="comment"># 预测图片的路径</span></span><br><span class="line">    divide_picture(infer_path)               <span class="comment"># 按车牌字符划分图片</span></span><br><span class="line">    name_dict = match_labels(label_dict)     <span class="comment"># 获取转换标签的字典</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">2</span>:     <span class="comment"># 跳过蓝牌中的“•”号</span></span><br><span class="line">            infer_label += <span class="string">&quot;•&quot;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        char_img = load_image(<span class="string">&quot;./data/%d.png&quot;</span> % i)</span><br><span class="line">        <span class="comment"># 将数据转化为fluid.dygraph能够接受的Variable类型的对象：</span></span><br><span class="line">        char_img = fluid.dygraph.to_variable(char_img)</span><br><span class="line">        result = model(char_img)            <span class="comment"># 模型预测，返回一个概率数组</span></span><br><span class="line">        lab = np.argmax(result.numpy())     <span class="comment"># 返回数组result中的最大值的索引值</span></span><br><span class="line">        infer_label += name_dict[<span class="built_in">str</span>(lab)]  <span class="comment"># 将字符的预测结果加入到总结果中</span></span><br><span class="line"></span><br><span class="line">    display(Image.<span class="built_in">open</span>(infer_path))             <span class="comment"># 展示预测车牌</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n该车牌的预测结果为:&quot;</span>, infer_label)  <span class="comment"># 展示预测结果</span></span><br></pre></td></tr></table></figure>
<p>模型预测结果如下：</p>
<pre><code>该车牌的预测结果为: 苏A•UP678
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/20210211225000923.png#pic_center"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><blockquote>
<ul>
<li>如果您发现项目存在问题，或者如果您有更好的建议，欢迎在下方评论区中留言讨论~</li>
<li>这是本项目的链接：<a target="_blank" rel="noopener" href="https://aistudio.baidu.com/aistudio/projectdetail/764714?shared=1">实验项目 - Baidu AI Studio</a>，点击<code>fork</code>可直接在AI Studio运行~</li>
<li>这是我的个人主页：<a target="_blank" rel="noopener" href="https://aistudio.baidu.com/aistudio/personalcenter/thirdview/118633">个人主页 - Baidu AI Studio</a>，来AI Studio互粉吧，等你哦~</li>
</ul>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://xinkai-tang.github.io">Kevin Tang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://xinkai-tang.github.io/2021/10/24/%E3%80%90LeNet5%E3%80%91%E7%AE%80%E5%8D%95%E8%BD%A6%E7%89%8C%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/">https://xinkai-tang.github.io/2021/10/24/%E3%80%90LeNet5%E3%80%91%E7%AE%80%E5%8D%95%E8%BD%A6%E7%89%8C%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://xinkai-tang.github.io" target="_blank">Kevin Tang</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89-paddlepaddle/">深度学习, 计算机视觉, paddlepaddle</a></div><div class="post_share"><div class="social-share" data-image="/img/banner.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/10/24/%E3%80%90Sarsa&amp;Q-Learning%E3%80%91%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/"><img class="prev-cover" src="/img/banner.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【Sarsa &amp; Q-Learning】强化学习入门</div></div></a></div><div class="next-post pull-right"><a href="/2021/03/05/%E3%80%90VGG16%E3%80%91%E5%8F%A3%E7%BD%A9%E4%BA%BA%E8%84%B8%E5%88%86%E7%B1%BB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/"><img class="next-cover" src="/img/banner.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【VGG16】口罩人脸分类（动态图版）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/02/08/%E3%80%90DNN%E3%80%91%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E8%AF%86%E5%88%AB/" title="【DNN】手写数字识别"><img class="cover" src="/img/banner.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-08</div><div class="title">【DNN】手写数字识别</div></div></a></div><div><a href="/2021/02/12/%E3%80%90AlexNet%E3%80%91%E6%95%B0%E5%AD%97%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/" title="【AlexNet】数字手势识别（动态图版）"><img class="cover" src="/img/banner.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-12</div><div class="title">【AlexNet】数字手势识别（动态图版）</div></div></a></div><div><a href="/2021/03/05/%E3%80%90VGG16%E3%80%91%E5%8F%A3%E7%BD%A9%E4%BA%BA%E8%84%B8%E5%88%86%E7%B1%BB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/" title="【VGG16】口罩人脸分类（动态图版）"><img class="cover" src="/img/banner.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-05</div><div class="title">【VGG16】口罩人脸分类（动态图版）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Kevin Tang</div><div class="author-info__description">武汉大学2022级软件工程专硕</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/XinKai-Tang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/XinKai-Tang" target="_blank" title="Github"><i class="fab fa-github-alt"></i></a><a class="social-icon" href="https://aistudio.baidu.com/aistudio/personalcenter/thirdview/118633" target="_blank" title="AI-Studio"><i class="fab fa-paypal"></i></a><a class="social-icon" href="mailto:kevin-tang@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Hi, welcome to my blog!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%AF%BC%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">问题导入</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.</span> <span class="toc-text">一、基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8A%A8%E6%80%81%E5%9B%BEDyGraph"><span class="toc-number">2.1.</span> <span class="toc-text">1. 动态图DyGraph</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-LeNet5%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.2.</span> <span class="toc-text">2. LeNet5模型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">3.</span> <span class="toc-text">二、实验数据集</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="toc-number">4.</span> <span class="toc-text">三、实验步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97"><span class="toc-number">4.1.</span> <span class="toc-text">0. 导入模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-number">4.2.</span> <span class="toc-text">1. 数据准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="toc-number">4.3.</span> <span class="toc-text">2. 网络配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83"><span class="toc-number">4.4.</span> <span class="toc-text">3. 模型训练</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0"><span class="toc-number">4.5.</span> <span class="toc-text">4. 模型评估</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B"><span class="toc-number">4.6.</span> <span class="toc-text">5. 模型预测</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="toc-number">5.</span> <span class="toc-text">写在最后</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/10/24/%E3%80%90Sarsa&amp;Q-Learning%E3%80%91%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" title="【Sarsa &amp; Q-Learning】强化学习入门"><img src="/img/banner.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【Sarsa &amp; Q-Learning】强化学习入门"/></a><div class="content"><a class="title" href="/2021/10/24/%E3%80%90Sarsa&amp;Q-Learning%E3%80%91%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" title="【Sarsa &amp; Q-Learning】强化学习入门">【Sarsa &amp; Q-Learning】强化学习入门</a><time datetime="2021-10-24T15:59:59.000Z" title="发表于 2021-10-24 23:59:59">2021-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/24/%E3%80%90LeNet5%E3%80%91%E7%AE%80%E5%8D%95%E8%BD%A6%E7%89%8C%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/" title="【LeNet5】简单车牌识别（动态图版）"><img src="/img/banner.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【LeNet5】简单车牌识别（动态图版）"/></a><div class="content"><a class="title" href="/2021/10/24/%E3%80%90LeNet5%E3%80%91%E7%AE%80%E5%8D%95%E8%BD%A6%E7%89%8C%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/" title="【LeNet5】简单车牌识别（动态图版）">【LeNet5】简单车牌识别（动态图版）</a><time datetime="2021-10-24T04:58:10.000Z" title="发表于 2021-10-24 12:58:10">2021-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/05/%E3%80%90VGG16%E3%80%91%E5%8F%A3%E7%BD%A9%E4%BA%BA%E8%84%B8%E5%88%86%E7%B1%BB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/" title="【VGG16】口罩人脸分类（动态图版）"><img src="/img/banner.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【VGG16】口罩人脸分类（动态图版）"/></a><div class="content"><a class="title" href="/2021/03/05/%E3%80%90VGG16%E3%80%91%E5%8F%A3%E7%BD%A9%E4%BA%BA%E8%84%B8%E5%88%86%E7%B1%BB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/" title="【VGG16】口罩人脸分类（动态图版）">【VGG16】口罩人脸分类（动态图版）</a><time datetime="2021-03-05T12:35:27.000Z" title="发表于 2021-03-05 20:35:27">2021-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/12/%E3%80%90AlexNet%E3%80%91%E6%95%B0%E5%AD%97%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/" title="【AlexNet】数字手势识别（动态图版）"><img src="/img/banner.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【AlexNet】数字手势识别（动态图版）"/></a><div class="content"><a class="title" href="/2021/02/12/%E3%80%90AlexNet%E3%80%91%E6%95%B0%E5%AD%97%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/" title="【AlexNet】数字手势识别（动态图版）">【AlexNet】数字手势识别（动态图版）</a><time datetime="2021-02-12T04:21:17.000Z" title="发表于 2021-02-12 12:21:17">2021-02-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/09/%E3%80%90%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E3%80%91Python%E5%AE%9E%E7%8E%B0%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" title="【排序算法】Python实现常用的排序算法"><img src="/img/banner.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【排序算法】Python实现常用的排序算法"/></a><div class="content"><a class="title" href="/2021/02/09/%E3%80%90%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E3%80%91Python%E5%AE%9E%E7%8E%B0%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" title="【排序算法】Python实现常用的排序算法">【排序算法】Python实现常用的排序算法</a><time datetime="2021-02-09T09:59:46.000Z" title="发表于 2021-02-09 17:59:46">2021-02-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Kevin Tang</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://xinkai-tang.github.io/2021/10/24/%E3%80%90LeNet5%E3%80%91%E7%AE%80%E5%8D%95%E8%BD%A6%E7%89%8C%E8%AF%86%E5%88%AB%EF%BC%88%E5%8A%A8%E6%80%81%E5%9B%BE%E7%89%88%EF%BC%89/'
    this.page.identifier = '2021/10/24/【LeNet5】简单车牌识别（动态图版）/'
    this.page.title = '【LeNet5】简单车牌识别（动态图版）'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="坚持真理,坚守理想,践行初心,担当使命,不怕牺牲,英勇斗争,对党忠诚,不负人民" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>